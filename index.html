<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shop</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="app"></div>
  
  <script>
    const products = [
      { id: 1, name: 'Headphones', price: 79.99, emoji: 'ðŸŽ§' },
      { id: 2, name: 'Smart Watch', price: 199.99, emoji: 'âŒš' },
      { id: 3, name: 'Phone Case', price: 24.99, emoji: 'ðŸ“±' },
      { id: 4, name: 'Charger', price: 39.99, emoji: 'ðŸ”‹' },
    ];
    
    let cart = [];
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();
    
    function render() {
      const app = document.getElementById('app');
      
      let html = '<div class="p-4 bg-gray-50 min-h-screen">';
      html += '<h1 class="text-2xl font-bold mb-4">Shop</h1>';
      html += '<div class="grid grid-cols-2 gap-4">';
      
      products.forEach(p => {
        html += `
          <div class="bg-white p-4 rounded-lg shadow">
            <div class="text-4xl mb-2 text-center">${p.emoji}</div>
            <div class="font-bold">${p.name}</div>
            <div class="text-blue-600">$${p.price}</div>
            <button onclick="addToCart(${p.id})" class="mt-2 bg-blue-500 text-white px-4 py-2 rounded w-full">
              Add to Cart
            </button>
          </div>
        `;
      });
      
      html += '</div></div>';
      app.innerHTML = html;
      
      tg.MainButton.setText(`Checkout ($${getTotal().toFixed(2)})`);
      if (cart.length > 0) {
        tg.MainButton.show();
      } else {
        tg.MainButton.hide();
      }
    }
    
    function addToCart(id) {
      const product = products.find(p => p.id === id);
      cart.push(product);
      tg.HapticFeedback.impactOccurred('light');
      render();
    }
    
    function getTotal() {
      return cart.reduce((sum, item) => sum + item.price, 0);
    }
    
    tg.MainButton.onClick(() => {
      tg.sendData(JSON.stringify({ cart, total: getTotal() }));
      tg.close();
    });
    
    render();
  </script>
</body>
</html>
